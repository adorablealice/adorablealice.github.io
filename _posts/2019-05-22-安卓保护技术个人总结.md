---
layout:     post                    # 使用的布局（不需要改）
title:      保护技术个人总结            # 标题 
subtitle:   安卓逆向 保护 混淆      #副标题
date:       2019-05-22              # 时间
author:     BC                      # 作者
header-img: img/post-bg-fake.png    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - 安卓逆向
---

# 前言
    继上篇实现了自己的hook工具后，如果想要把这些代码投入业务中，还需要做好安全防护。
    自觉初出茅庐，水平足以对已有的知识进行梳理。
    本文总结了操作简单，效果良好的java层和native层的加密和混淆。
    本文无图，MD 插个图太烦了
    
# native层保护
## 1. ollvm混淆
[交大版OLLVM Armariris ](https://goldsnow.github.io/2017/08/07/android-ollvm/)  

    Armariris比起官方版ollvm，少了bcf伪造控制流，多了字符串加密。
    日后有空可以进行整合，毕竟ollvm源码思路清晰。
## 2.隐藏符号表
    app的gradle文件中添加cflags
    defaultConfig {
        ...
        externalNativeBuild {
            cmake {
                cppFlags "-fvisibility=hidden"
            }
        }
        ...
    }
## 3.section加密
[Android逆向之旅—基于对so中的section加密技术实现so加固](http://www.520monkey.com/archives/563)  

    section加密的样本很多，大多可以通过F8大神的SoDumpHelper来dump。
    所以要在loader中做调用者检测
## 4.反调试技巧
## 5.
## 6.加密关键方法的context检查(防黑盒调用)
## 7.签名检查 自身CRC（或学习数盟 只检查随机部分字节）

# java层保护
## 1.超强空白混淆
## 2.字符串加密
## 3.反jadx字节码trick（仿美团）

[Android安全之应用防dex2jar原理及实现](http://ivonhoe.github.io/2017/02/09/%E7%BE%8E%E5%9B%A2%E5%A6%82%E4%BD%95%E9%98%B2dex2jar/)

# 通用保护技巧
## 1.检查调用栈（不止找xposed 还可找脱壳插件特征）
## 2.检测maps里的module
## 3.仿反作弊SDK的设备指纹验证
## 4.风险APP检查

> to be continued 挖坑真tm有意思